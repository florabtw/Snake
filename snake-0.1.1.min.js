function Point(t,i){this.x=t,this.y=i}function Controls(t){function i(i){var r=i.pageX-t.offsetLeft,h=i.pageY-t.offsetTop;n(r,h)?d.turnLeft():e(r,h)?d.turnRight():o(r,h)?d.turnUp():s(r,h)&&d.turnDown()}function n(t,i){return r(a,t,i)}function e(t,i){return r(u,t,i)}function o(t,i){return r(l,t,i)}function s(t,i){return r(f,t,i)}function r(t,i,n){var e=t.x<=i&&i<=t.x+h,o=t.y<=n&&n<=t.y+h;return e&&o}const h=50,c=5;var a,u,l,f,d=null;this.updateLocation=function(){a=new Point(t.width-150-15,t.height-h-c),f=new Point(t.width-100-10,t.height-h-c),u=new Point(t.width-h-c,t.height-h-c),l=new Point(t.width-100-10,t.height-100-10)},this.updateLocation(),this.register=function(t){d=t},this.listen=function(){window.addEventListener("mousedown",i,!1)},this.draw=function(t){t.fillStyle="rgba(0, 0, 0, 0.1)",t.fillRect(a.x,a.y,h,h),t.fillRect(u.x,u.y,h,h),t.fillRect(l.x,l.y,h,h),t.fillRect(f.x,f.y,h,h)}}function ResetButton(t,i){function n(n){var o=n.pageX-t.offsetLeft,s=n.pageY-t.offsetTop,r=e.x<=o&&o<=e.x+e.width,h=e.y<=s&&s<=e.y+e.height;r&&h&&i.reset()}this.x=10,this.y=t.height-50,this.width=100,this.height=40;var e=this;this.updateLocation=function(){this.y=t.height-50},this.listen=function(){window.addEventListener("mousedown",n,!1)},this.draw=function(t){t.fillRect(this.x,this.y,this.width,this.height),t.font="16px sans-serif",t.textAlign="center",t.textBaseline="middle",t.fillStyle="#333";var i=this.x+this.width/2,n=this.y+this.height/2;t.fillText("Reset",i,n)}}function Score(){this.score=0,this.reset=function(){this.score=0},this.increment=function(){this.score++},this.draw=function(t){t.font="bold 36px sans-serif",t.textAlign="left",t.textBaseline="top",t.fillStyle="rgba(0, 0, 0, 0.1)",t.fillText("Score: "+this.score,10,10)}}function Snake(){this.points=[new Point(BLOCK_SIZE,BLOCK_SIZE)],this.direction=Direction.RIGHT;var t=this;this.reset=function(){this.points=[new Point(50,50)],this.direction=Direction.RIGHT},this.headCollidesWithWall=function(t){var i=this.points[0],n=0>i.x||i.x>t.width-BLOCK_SIZE,e=0>i.y||i.y>t.height-BLOCK_SIZE;return n||e},this.headCollidesWithSelf=function(){var t=this.points[0];for(i=1;i<this.points.length;i++)if(t.x==this.points[i].x&&t.y==this.points[i].y)return!0;return!1},this.headCollidesWithApple=function(t){var i=this.points[0];return i.x===t.x&&i.y===t.y},this.listenForKeyPress=function(i){function n(i){i.preventDefault();var n=i.keyCode;switch(n){case 37:t.turnLeft();break;case 38:t.turnUp();break;case 39:t.turnRight();break;case 40:t.turnDown()}}i.addEventListener("keydown",n)},this.turnLeft=function(){t.direction!==Direction.RIGHT&&(t.direction=Direction.LEFT)},this.turnRight=function(){t.direction!==Direction.LEFT&&(t.direction=Direction.RIGHT)},this.turnUp=function(){t.direction!==Direction.DOWN&&(t.direction=Direction.UP)},this.turnDown=function(){t.direction!==Direction.UP&&(t.direction=Direction.DOWN)},this.draw=function(t){for(t.fillStyle="black",i=0;i<this.points.length;i++)t.fillRect(this.points[i].x,this.points[i].y,BLOCK_SIZE,BLOCK_SIZE)}}function Apple(t){function i(){var i=Math.random()*(t.width-BLOCK_SIZE);return Math.round(i/BLOCK_SIZE)*BLOCK_SIZE}function n(){var i=Math.random()*(t.height-BLOCK_SIZE);return Math.round(i/BLOCK_SIZE)*BLOCK_SIZE}this.x=i(),this.y=n(),this.move=function(){this.x=i(),this.y=n()},this.draw=function(t){t.fillRect(this.x,this.y,BLOCK_SIZE,BLOCK_SIZE)}}function SnakeGame(t){function n(){var n=Date.now();if(n-u>50){if(u=n,o.headCollidesWithApple(s)){var e=o.points[o.points.length-1];o.points.push(new Point(e.x,e.y)),h.increment(),s.move()}for(i=o.points.length-1;i>0;i--)o.points[i].x=o.points[i-1].x,o.points[i].y=o.points[i-1].y;o.direction===Direction.LEFT?o.points[0].x-=BLOCK_SIZE:o.direction===Direction.RIGHT?o.points[0].x+=BLOCK_SIZE:o.direction===Direction.UP?o.points[0].y-=BLOCK_SIZE:o.points[0].y+=BLOCK_SIZE,(o.headCollidesWithWall(t)||o.headCollidesWithSelf())&&(l=!0)}}function e(){a.clearRect(0,0,t.width,t.height),o.draw(a),s.draw(a),h.draw(a),r.draw(a),null!==c&&c.draw(a)}var o=new Snake,s=new Apple(t),r=new ResetButton(t,this),h=new Score,c=null,a=t.getContext("2d"),u=Date.now(),l=!1;this.resize=function(){var i=s.x>t.width-BLOCK_SIZE,n=s.y>t.height-BLOCK_SIZE;(i||n)&&s.move(),r.updateLocation(),null!==c&&c.updateLocation(),e()},this.reset=function(){l=!1,u=Date.now(),o.reset(),s.move(),h.reset()},this.enableControls=function(){c=new Controls(t),c.register(o)},this.play=function(){function i(){l||(n(),e())}if(r.listen(),o.listenForKeyPress(t),null!==c&&c.listen(),null!==window.requestAnimationFrame){var s=function(){i(),window.requestAnimationFrame(s)};window.requestAnimationFrame(s)}else setInterval(i,1e3/60)}}const BLOCK_SIZE=10;var Direction={LEFT:0,RIGHT:1,UP:2,DOWN:3};